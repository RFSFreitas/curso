abjutils::rm_accent
library(ggplot2)
library(dplyr)
library(stringr)
library(lubridate)
library(httr)
library(xml2)
library(rvest)
library(abjutils)
df <- data.frame(ano = 2010:2020,
prop = c(0.01, 0.09, 0.14, 0.18, 0.23, 0.34, 0.39, 0.44, 0.60, 0.88, 1.1))
ggplot(df, aes(x = as.character(ano), y = prop, group = 1)) +
geom_line() +
geom_point(size=5, shape = 22, fill = "green") +
guides(fill = FALSE) +
scale_y_continuous(breaks = 0:11/10, labels = scales::percent) +
xlab("Ano") +
ylab("Proporção de usuários no mundo")
ggplot(df, aes(x = as.character(ano), y = prop, group = 1)) +
geom_line() +
geom_point(size=5, shape = 22, fill = "green") +
guides(fill = FALSE) +
scale_y_continuous(breaks = 0:11/10, labels = scales::percent) +
geom_hline(yintercept = 1, colour = 'red') +
xlab("Ano") +
ylab("Proporção de usuários no mundo")
ggplot(df, aes(x = usa, y = salario, fill = usa)) +
geom_boxplot(width = 0.5) +
guides(fill=FALSE) +
xlab("Utiliza o ggplot") +
ylab("Salário (reais)")
df <- data.frame(usa = rep(c("Sim", "Não"), c(100,100)),
salario = c(rnorm(100, 7000, 1000), abs(rnorm(100, 2000, 1200))))
df$salario[1] = 2500
ggplot(df, aes(x = usa, y = salario, fill = usa)) +
geom_boxplot(width = 0.5) +
guides(fill=FALSE) +
xlab("Utiliza o ggplot") +
ylab("Salário (reais)")
df <- data.frame(usa = rep(c("Sim", "Não"), c(5, 5)),
expec = c(70, 80, 85, 96, 121, 78, 74, 71, 66, 59),
ano = rep(2010:2014, 2))
ggplot(df, aes(x = ano, y = expec, fill = usa)) +
geom_bar(stat="identity", width = 0.4, position = "dodge") +
xlab("Ano") +
ylab("Expectativa de vida") +
labs(fill = "Utiliza o ggplot?")
df <- data.frame(usa = rep(c("Sim", "Não"), c(5, 5)),
expec = c(70, 80, 85, 96, 121, 78, 74, 71, 66, 59),
ano = rep(2010:2014, 2))
ggplot(df, aes(x = ano, y = expec, fill = usa)) +
geom_bar(stat="identity", width = 0.4, position = "dodge") +
geom_hline(yintercept = 100, colour = 'red', linetype = 2) +
xlab("Ano") +
ylab("Expectativa de vida") +
labs(fill = "Utiliza o ggplot?")
df <- data.frame(usa = rep(c("Sim", "Não"), c(5, 5)),
expec = c(70, 80, 85, 96, 121, 78, 74, 71, 66, 59),
ano = rep(2012:2016, 2))
ggplot(df, aes(x = ano, y = expec, fill = usa)) +
geom_bar(stat="identity", width = 0.4, position = "dodge") +
geom_hline(yintercept = 100, colour = 'red', linetype = 2) +
xlab("Ano") +
ylab("Expectativa de vida") +
labs(fill = "Utiliza o ggplot?")
df <- data.frame(usa = rep(c("Sim", "Não"), c(5, 5)),
expec = c(70, 80, 85, 96, 121, 78, 74, 71, 66, 59),
ano = rep(2012:2016, 2))
ggplot(df, aes(x = ano, y = expec, fill = usa)) +
geom_bar(stat="identity", width = 0.4, position = "dodge") +
geom_hline(yintercept = 100, colour = 'red', linetype = 2) +
xlab("Ano") +
ylab("Expectativa de vida") +
labs(fill = "Utiliza o ggplot?") +
theme_bw()
df <- data.frame(usa = rep(c("Sim", "Não"), c(100,100)),
salario = c(rnorm(100, 7000, 1000), abs(rnorm(100, 2000, 1200))))
df$salario[1] = 2500
ggplot(df, aes(x = usa, y = salario, fill = usa)) +
geom_boxplot(width = 0.5) +
guides(fill=FALSE) +
xlab("Utiliza o ggplot") +
ylab("Salário (reais)")
df <- data.frame(ano = 2010:2020,
prop = c(0.01, 0.09, 0.14, 0.18, 0.23, 0.34, 0.39, 0.44, 0.60, 0.88, 1.1))
ggplot(df, aes(x = as.character(ano), y = prop, group = 1)) +
geom_line() +
geom_point(size=5, shape = 22, fill = "royalblue") +
guides(fill = FALSE) +
scale_y_continuous(breaks = 0:11/10, labels = scales::percent) +
geom_hline(yintercept = 1, colour = 'red') +
xlab("Ano") +
ylab("Proporção de usuários no mundo")
bnr::create_bn
ggplot(data = mtcars) +
geom_boxplot(aes(x = as.character(gear), y = mpg,
fill = as.character(gear)))
ggplot(data = mtcars) +
geom_boxplot(aes(x = as.character(gear), y = mpg,
fill = as.character(gear)))
ggplot(data = mtcars) +
geom_point(aes(x = disp, y = mpg, colour = as.character(am)))
ggplot(data = mtcars) +
geom_point(aes(x = disp, y = mpg, colour = as.character(am),
size = cyl))
d_cjsg <- readRDS('data-raw/d_cjsg.rds')
d_partes <- readRDS('data-raw/d_partes.rds')
d_decisoes <- readRDS('data-raw/d_decisoes.rds')
partes_apelacoes <- d_partes %>%
filter(tipo == 'apelado', str_detect(nome, '[Mm]inist')) %>%
mutate(n_processo = str_replace_all(arq, '[^0-9]', '')) %>%
select(n_processo)
decisoes <- d_decisoes %>%
mutate(n_processo = str_replace_all(arq, '[^0-9]', '')) %>%
semi_join(partes_apelacoes, 'n_processo') %>%
filter(situacao == 'Julgado') %>%
distinct(n_processo, decisao) %>%
mutate(tipo_decisao = tipos_decisao(decisao)) %>%
select(n_processo, tipo_decisao)
aux <- d_cjsg %>%
mutate(n_processo = str_replace_all(n_processo, '[^0-9]', '')) %>%
inner_join(decisoes, 'n_processo') %>%
mutate(data = dmy(data_julgamento)) %>%
mutate(ano_mes = floor_date(data, 'month'))
aux %>%
count(ano_mes, tipo_decisao) %>%
mutate(prop = n/sum(n)) %>%
ungroup %>%
ggplot(aes(x = ano_mes, y = prop, colour = tipo_decisao)) +
geom_line() +
geom_text(aes(y = 0.65, label = n, colour = NULL),
data = count(aux, ano_mes)) +
scale_x_date(breaks = scales::date_breaks('1 month'),
labels = scales::date_format("%b")) +
scale_y_continuous(labels = scales::percent) +
xlab('Tempo (meses)') +
ylab('Proporção de cada tipo de decisão') +
theme_bw()
tipos_decisao <- function(decisoes) {
ifelse(
str_detect(decisoes, negaram), 'negado', ifelse(
str_detect(decisoes, parcial), 'parcial', ifelse(
str_detect(decisoes, deram), 'provido', 'outros'
))
)
}
partes_apelacoes <- d_partes %>%
filter(tipo == 'apelado', str_detect(nome, '[Mm]inist')) %>%
mutate(n_processo = str_replace_all(arq, '[^0-9]', '')) %>%
select(n_processo)
decisoes <- d_decisoes %>%
mutate(n_processo = str_replace_all(arq, '[^0-9]', '')) %>%
semi_join(partes_apelacoes, 'n_processo') %>%
filter(situacao == 'Julgado') %>%
distinct(n_processo, decisao) %>%
mutate(tipo_decisao = tipos_decisao(decisao)) %>%
select(n_processo, tipo_decisao)
negaram <- regex('negaram', ignore_case = TRUE)
parcial <- regex('parcial', ignore_case = TRUE)
deram <- regex('deram', ignore_case = TRUE)
partes_apelacoes <- d_partes %>%
filter(tipo == 'apelado', str_detect(nome, '[Mm]inist')) %>%
mutate(n_processo = str_replace_all(arq, '[^0-9]', '')) %>%
select(n_processo)
decisoes <- d_decisoes %>%
mutate(n_processo = str_replace_all(arq, '[^0-9]', '')) %>%
semi_join(partes_apelacoes, 'n_processo') %>%
filter(situacao == 'Julgado') %>%
distinct(n_processo, decisao) %>%
mutate(tipo_decisao = tipos_decisao(decisao)) %>%
select(n_processo, tipo_decisao)
aux <- d_cjsg %>%
mutate(n_processo = str_replace_all(n_processo, '[^0-9]', '')) %>%
inner_join(decisoes, 'n_processo') %>%
mutate(data = dmy(data_julgamento)) %>%
mutate(ano_mes = floor_date(data, 'month'))
aux %>%
count(ano_mes, tipo_decisao) %>%
mutate(prop = n/sum(n)) %>%
ungroup %>%
ggplot(aes(x = ano_mes, y = prop, colour = tipo_decisao)) +
geom_line() +
geom_text(aes(y = 0.65, label = n, colour = NULL),
data = count(aux, ano_mes)) +
scale_x_date(breaks = scales::date_breaks('1 month'),
labels = scales::date_format("%b")) +
scale_y_continuous(labels = scales::percent) +
xlab('Tempo (meses)') +
ylab('Proporção de cada tipo de decisão') +
theme_bw()
d_cjsg %>%
separate(classe_assunto, c('classe', 'assunto'), sep = ' / ',
extra = 'merge', fill = 'right') %>%
group_by(assunto) %>%
mutate(n_assunto = n()) %>%
ungroup() %>%
mutate(assunto = ifelse(n_assunto < 5000, 'Outro', assunto)) %>%
count(orgao_julgador, assunto) %>%
mutate(ntot = sum(n), prop = n / ntot) %>%
ungroup %>%
filter(ntot > 1000) %>%
mutate(num = extract_numeric(orgao_julgador),
num = sprintf('%02d', num)) %>%
mutate(extra = str_detect(orgao_julgador, 'Extra'),
extra = ifelse(extra, 'Câmara Extraordinária',
'Câmara de Direito Criminal')) %>%
ggplot(aes(x = num, fill = assunto, y = prop)) +
geom_bar(stat = 'identity', colour = 'black') +
facet_wrap(~extra, scales = 'free_x') +
theme_bw() +
scale_y_continuous(labels = scales::percent) +
xlab('Órgão julgador') +
ylab('Proporção de processos por assunto') +
theme(legend.position = "bottom")
library(tidyr)
d_cjsg %>%
separate(classe_assunto, c('classe', 'assunto'), sep = ' / ',
extra = 'merge', fill = 'right') %>%
group_by(assunto) %>%
mutate(n_assunto = n()) %>%
ungroup() %>%
mutate(assunto = ifelse(n_assunto < 5000, 'Outro', assunto)) %>%
count(orgao_julgador, assunto) %>%
mutate(ntot = sum(n), prop = n / ntot) %>%
ungroup %>%
filter(ntot > 1000) %>%
mutate(num = extract_numeric(orgao_julgador),
num = sprintf('%02d', num)) %>%
mutate(extra = str_detect(orgao_julgador, 'Extra'),
extra = ifelse(extra, 'Câmara Extraordinária',
'Câmara de Direito Criminal')) %>%
ggplot(aes(x = num, fill = assunto, y = prop)) +
geom_bar(stat = 'identity', colour = 'black') +
facet_wrap(~extra, scales = 'free_x') +
theme_bw() +
scale_y_continuous(labels = scales::percent) +
xlab('Órgão julgador') +
ylab('Proporção de processos por assunto') +
theme(legend.position = "bottom")
d_cjsg %>%
mutate(n_processo = str_replace_all(n_processo, '[^0-9]', '')) %>%
inner_join(decisoes, 'n_processo') %>%
count(orgao_julgador, tipo_decisao) %>%
mutate(ntot = sum(n), prop = n / ntot) %>%
ungroup() %>%
filter(ntot > 10) %>%
mutate(num = extract_numeric(orgao_julgador),
num = sprintf('%02d', num)) %>%
mutate(extra = str_detect(orgao_julgador, 'Extra'),
extra = ifelse(extra, 'Câmara Extraordinária',
'Câmara de Direito Criminal')) %>%
ggplot(aes(x = num, fill = tipo_decisao, y = prop)) +
geom_bar(stat = 'identity', colour = 'black') +
facet_wrap(~extra, scales = 'free_x') +
theme_bw() +
scale_y_continuous(labels = scales::percent) +
xlab('Órgão julgador') +
ylab('Proporção de processos por tipo de decisão') +
theme(legend.position = "bottom")
